{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "9b6c7747",
   "metadata": {
    "papermill": {
     "duration": 0.006057,
     "end_time": "2025-12-23T10:03:48.580332",
     "exception": false,
     "start_time": "2025-12-23T10:03:48.574275",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# **<span style=\"color: green;\">Predictive Regression Tool Using Gradio</span>**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "605335ed",
   "metadata": {
    "papermill": {
     "duration": 0.004841,
     "end_time": "2025-12-23T10:03:48.590229",
     "exception": false,
     "start_time": "2025-12-23T10:03:48.585388",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## **1. Medical Insurance Cost **\n",
    "---\n",
    "(https://www.kaggle.com/datasets/mosapabdelghany/medical-insurance-cost-dataset)\n",
    "\n",
    "---\n",
    "\n",
    "For Assessment 2, we are required to solve a Machine Learning problem of any type. For this project, I decided to work with a Regression Task. We were also instructed to use Gradio to work with the Machine Learning Model."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99bbf361",
   "metadata": {
    "papermill": {
     "duration": 0.00487,
     "end_time": "2025-12-23T10:03:48.600866",
     "exception": false,
     "start_time": "2025-12-23T10:03:48.595996",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **1.1 Importing**\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "72184ec3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:03:48.612556Z",
     "iopub.status.busy": "2025-12-23T10:03:48.611757Z",
     "iopub.status.idle": "2025-12-23T10:03:59.429398Z",
     "shell.execute_reply": "2025-12-23T10:03:59.428254Z"
    },
    "papermill": {
     "duration": 10.825625,
     "end_time": "2025-12-23T10:03:59.431369",
     "exception": false,
     "start_time": "2025-12-23T10:03:48.605744",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import gradio as gr\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib as plt\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.tree import DecisionTreeRegressor\n",
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error\n",
    "from bayes_opt import BayesianOptimization\n",
    "from sklearn.datasets import make_regression"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "455c2d87",
   "metadata": {
    "papermill": {
     "duration": 0.005026,
     "end_time": "2025-12-23T10:03:59.441550",
     "exception": false,
     "start_time": "2025-12-23T10:03:59.436524",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **1.2 Printing CSV and Data Checking**\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3dbe229e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:03:59.453075Z",
     "iopub.status.busy": "2025-12-23T10:03:59.452432Z",
     "iopub.status.idle": "2025-12-23T10:03:59.508324Z",
     "shell.execute_reply": "2025-12-23T10:03:59.507151Z"
    },
    "papermill": {
     "duration": 0.063986,
     "end_time": "2025-12-23T10:03:59.510363",
     "exception": false,
     "start_time": "2025-12-23T10:03:59.446377",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1338, 7)\n",
      "Index(['age', 'sex', 'bmi', 'children', 'smoker', 'region', 'charges'], dtype='object')\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>sex</th>\n",
       "      <th>bmi</th>\n",
       "      <th>children</th>\n",
       "      <th>smoker</th>\n",
       "      <th>region</th>\n",
       "      <th>charges</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>19</td>\n",
       "      <td>female</td>\n",
       "      <td>27.900</td>\n",
       "      <td>0</td>\n",
       "      <td>yes</td>\n",
       "      <td>southwest</td>\n",
       "      <td>16884.92400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>18</td>\n",
       "      <td>male</td>\n",
       "      <td>33.770</td>\n",
       "      <td>1</td>\n",
       "      <td>no</td>\n",
       "      <td>southeast</td>\n",
       "      <td>1725.55230</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28</td>\n",
       "      <td>male</td>\n",
       "      <td>33.000</td>\n",
       "      <td>3</td>\n",
       "      <td>no</td>\n",
       "      <td>southeast</td>\n",
       "      <td>4449.46200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>33</td>\n",
       "      <td>male</td>\n",
       "      <td>22.705</td>\n",
       "      <td>0</td>\n",
       "      <td>no</td>\n",
       "      <td>northwest</td>\n",
       "      <td>21984.47061</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32</td>\n",
       "      <td>male</td>\n",
       "      <td>28.880</td>\n",
       "      <td>0</td>\n",
       "      <td>no</td>\n",
       "      <td>northwest</td>\n",
       "      <td>3866.85520</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   age     sex     bmi  children smoker     region      charges\n",
       "0   19  female  27.900         0    yes  southwest  16884.92400\n",
       "1   18    male  33.770         1     no  southeast   1725.55230\n",
       "2   28    male  33.000         3     no  southeast   4449.46200\n",
       "3   33    male  22.705         0     no  northwest  21984.47061\n",
       "4   32    male  28.880         0     no  northwest   3866.85520"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mic = pd.read_csv('/kaggle/input/medical-insurance-cost-dataset/insurance.csv')\n",
    "print(mic.shape)\n",
    "print(mic.columns)\n",
    "mic.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7185d32f",
   "metadata": {
    "papermill": {
     "duration": 0.005171,
     "end_time": "2025-12-23T10:03:59.520966",
     "exception": false,
     "start_time": "2025-12-23T10:03:59.515795",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#### **1.21 Cleaning Data**\n",
    "---\n",
    "It is still good to check if any cells have missing or unsupported data. The isna().sum() functions from pandas are used together to check for missing values."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "e6cc331f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:03:59.532739Z",
     "iopub.status.busy": "2025-12-23T10:03:59.532351Z",
     "iopub.status.idle": "2025-12-23T10:03:59.540950Z",
     "shell.execute_reply": "2025-12-23T10:03:59.540008Z"
    },
    "papermill": {
     "duration": 0.016434,
     "end_time": "2025-12-23T10:03:59.542435",
     "exception": false,
     "start_time": "2025-12-23T10:03:59.526001",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "age         0\n",
       "sex         0\n",
       "bmi         0\n",
       "children    0\n",
       "smoker      0\n",
       "region      0\n",
       "charges     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mic.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3c4ff9c1",
   "metadata": {
    "papermill": {
     "duration": 0.005269,
     "end_time": "2025-12-23T10:03:59.553549",
     "exception": false,
     "start_time": "2025-12-23T10:03:59.548280",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **1.3 Regression Task**\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b88840ae",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:03:59.567008Z",
     "iopub.status.busy": "2025-12-23T10:03:59.565655Z",
     "iopub.status.idle": "2025-12-23T10:04:00.017697Z",
     "shell.execute_reply": "2025-12-23T10:04:00.016345Z"
    },
    "papermill": {
     "duration": 0.460426,
     "end_time": "2025-12-23T10:04:00.019639",
     "exception": false,
     "start_time": "2025-12-23T10:03:59.559213",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "X = mic.drop('charges', axis=1)\n",
    "X = pd.get_dummies(X, columns=['sex', 'smoker', 'region'], drop_first=True)\n",
    "y = mic['charges']\n",
    "\n",
    "train_X, val_X, train_y, val_y = train_test_split(X, y, test_size=0.2, random_state=42)\n",
    "\n",
    "LR = LinearRegression().fit(train_X, train_y)\n",
    "DTR = DecisionTreeRegressor().fit(train_X, train_y)\n",
    "RF = RandomForestRegressor().fit(train_X, train_y)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a40f2f01",
   "metadata": {
    "papermill": {
     "duration": 0.005198,
     "end_time": "2025-12-23T10:04:00.030239",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.025041",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **1.4 Model Performance & Optimization**\n",
    "---\n",
    "The accuracy of the models have to be determined to see if the tool is reliable and ready to be deployed for people to use."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "dbc96050",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:04:00.042826Z",
     "iopub.status.busy": "2025-12-23T10:04:00.042471Z",
     "iopub.status.idle": "2025-12-23T10:04:00.076126Z",
     "shell.execute_reply": "2025-12-23T10:04:00.074677Z"
    },
    "papermill": {
     "duration": 0.042602,
     "end_time": "2025-12-23T10:04:00.077988",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.035386",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Linear Regression\n",
      "R²: 0.78\n",
      "MAE: 4,181.19\n",
      "MSE: 33,596,915.85\n",
      "RMSE: 5,796.28\n",
      "\n",
      "Decision Tree\n",
      "R²: 0.67\n",
      "MAE: 3,535.86\n",
      "MSE: 51,402,427.70\n",
      "RMSE: 7,169.55\n",
      "\n",
      "Random Forest\n",
      "R²: 0.87\n",
      "MAE: 2,528.44\n",
      "MSE: 20,793,197.83\n",
      "RMSE: 4,559.96\n"
     ]
    }
   ],
   "source": [
    "def evaluate(model, X_val, y_val):\n",
    "    preds = model.predict(X_val)\n",
    "    r2 = r2_score(y_val, preds)\n",
    "    mae = mean_absolute_error(y_val, preds)\n",
    "    mse = mean_squared_error(y_val, preds)\n",
    "    rmse = np.sqrt(mean_squared_error(y_val, preds))\n",
    "    return r2, mae, mse, rmse\n",
    "\n",
    "# Linear Regression \n",
    "r2_lr, mae_lr, mse_lr, rmse_lr = evaluate(LR, val_X, val_y) \n",
    "print(\"\\nLinear Regression\") \n",
    "print(f\"R²: {r2_lr:.2f}\") \n",
    "print(f\"MAE: {mae_lr:,.2f}\") \n",
    "print(f\"MSE: {mse_lr:,.2f}\")\n",
    "print(f\"RMSE: {rmse_lr:,.2f}\")\n",
    "    \n",
    "# Decision Tree \n",
    "r2_dt, mae_dt, mse_dt, rmse_dt = evaluate(DTR, val_X, val_y) \n",
    "print(\"\\nDecision Tree\") \n",
    "print(f\"R²: {r2_dt:.2f}\") \n",
    "print(f\"MAE: {mae_dt:,.2f}\") \n",
    "print(f\"MSE: {mse_dt:,.2f}\") \n",
    "print(f\"RMSE: {rmse_dt:,.2f}\")\n",
    "\n",
    "# Random Forest \n",
    "r2_rf, mae_rf, mse_rf, rmse_rf = evaluate(RF, val_X, val_y) \n",
    "print(\"\\nRandom Forest\") \n",
    "print(f\"R²: {r2_rf:.2f}\") \n",
    "print(f\"MAE: {mae_rf:,.2f}\") \n",
    "print(f\"MSE: {mse_rf:,.2f}\")\n",
    "print(f\"RMSE: {rmse_rf:,.2f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cb1405fc",
   "metadata": {
    "papermill": {
     "duration": 0.005217,
     "end_time": "2025-12-23T10:04:00.088789",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.083572",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#### **1.41 Optimization**\n",
    "---\n",
    "With evaluation metrics, lower values are better for MAE, MSE, and RMSE. As for the R² score, it should be higher. Out of the models evaluated so far, Random Forest had the best performance out of the box, with the Decision Tree model performing the least."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "989117c8",
   "metadata": {
    "papermill": {
     "duration": 0.005358,
     "end_time": "2025-12-23T10:04:00.099543",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.094185",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "##### **1.41a Linear Regression Optimization** >> (Gradient Descent)\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f783eca3",
   "metadata": {
    "papermill": {
     "duration": 0.005243,
     "end_time": "2025-12-23T10:04:00.110016",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.104773",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "84f1367f",
   "metadata": {
    "papermill": {
     "duration": 0.005227,
     "end_time": "2025-12-23T10:04:00.120639",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.115412",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "##### **1.41b Decision Tree Optimization** >> (Hyperparameter Tuning)\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7a6c9ad0",
   "metadata": {
    "papermill": {
     "duration": 0.005332,
     "end_time": "2025-12-23T10:04:00.131197",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.125865",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "667f6726",
   "metadata": {
    "papermill": {
     "duration": 0.0054,
     "end_time": "2025-12-23T10:04:00.141851",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.136451",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "##### **1.41c Random Forest Optimization** >> ()\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "87526d05",
   "metadata": {
    "papermill": {
     "duration": 0.005131,
     "end_time": "2025-12-23T10:04:00.152368",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.147237",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "22b1429e",
   "metadata": {
    "papermill": {
     "duration": 0.005314,
     "end_time": "2025-12-23T10:04:00.163005",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.157691",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **1.5 Functions**\n",
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "29d27b28",
   "metadata": {
    "papermill": {
     "duration": 0.00532,
     "end_time": "2025-12-23T10:04:00.174099",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.168779",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#### **1.51 Function 1**\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8d3e717b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:04:00.186855Z",
     "iopub.status.busy": "2025-12-23T10:04:00.186490Z",
     "iopub.status.idle": "2025-12-23T10:04:00.193124Z",
     "shell.execute_reply": "2025-12-23T10:04:00.191940Z"
    },
    "papermill": {
     "duration": 0.0156,
     "end_time": "2025-12-23T10:04:00.195102",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.179502",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def build_input(age, sex, bmi, children, smoker, region):\n",
    "    input_row = pd.DataFrame(0, index=[0], columns=X.columns)\n",
    "\n",
    "    input_row['age'] = age\n",
    "    input_row['bmi'] = bmi\n",
    "    input_row['children'] = children\n",
    "\n",
    "    # one-hot categorical\n",
    "    col = f\"sex_{sex}\"\n",
    "    if col in input_row.columns:\n",
    "        input_row[col] = 1\n",
    "\n",
    "    col = f\"smoker_{smoker}\"\n",
    "    if col in input_row.columns:\n",
    "        input_row[col] = 1\n",
    "\n",
    "    col = f\"region_{region}\"\n",
    "    if col in input_row.columns:\n",
    "        input_row[col] = 1\n",
    "\n",
    "    return input_row"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "988072ad",
   "metadata": {
    "papermill": {
     "duration": 0.005325,
     "end_time": "2025-12-23T10:04:00.205893",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.200568",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#### **1.52 Function 2**\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4edba9af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:04:00.218590Z",
     "iopub.status.busy": "2025-12-23T10:04:00.217506Z",
     "iopub.status.idle": "2025-12-23T10:04:00.224748Z",
     "shell.execute_reply": "2025-12-23T10:04:00.223657Z"
    },
    "papermill": {
     "duration": 0.015335,
     "end_time": "2025-12-23T10:04:00.226453",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.211118",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def predict(model, age, sex, bmi, children, smoker, region):\n",
    "    # dataset columns are lowercase, but user input first letters are uppercased for formatting\n",
    "    sex = sex.lower()\n",
    "    smoker = smoker.lower()\n",
    "    region = region.lower()\n",
    "\n",
    "    # sex, smoker, and regions are categorical strings \n",
    "    input_df = build_input(age, sex, bmi, children, smoker, region)\n",
    "    \n",
    "    if model == 'Linear Regression':\n",
    "        preds = LR.predict(input_df)[0]\n",
    "        return f\"${preds:,.2f}\"\n",
    "    elif model == 'Decision Tree':\n",
    "        preds = DTR.predict(input_df)[0]\n",
    "        return f\"${preds:,.2f}\"\n",
    "    elif model == 'Random Forest':\n",
    "        preds = RF.predict(input_df)[0]\n",
    "        return f\"${preds:,.2f}\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a96d02ad",
   "metadata": {
    "papermill": {
     "duration": 0.005268,
     "end_time": "2025-12-23T10:04:00.237300",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.232032",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **1.6 Gradio Interface**\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "5538f413",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-23T10:04:00.250162Z",
     "iopub.status.busy": "2025-12-23T10:04:00.248937Z",
     "iopub.status.idle": "2025-12-23T10:04:02.108089Z",
     "shell.execute_reply": "2025-12-23T10:04:02.107056Z"
    },
    "papermill": {
     "duration": 1.867441,
     "end_time": "2025-12-23T10:04:02.109956",
     "exception": false,
     "start_time": "2025-12-23T10:04:00.242515",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "* Running on local URL:  http://127.0.0.1:7860\n",
      "It looks like you are running Gradio on a hosted Jupyter notebook, which requires `share=True`. Automatically setting `share=True` (you can turn this off by setting `share=False` in `launch()` explicitly).\n",
      "\n",
      "* Running on public URL: https://cd465932b81ca1db1e.gradio.live\n",
      "\n",
      "This share link expires in 1 week. For free permanent hosting and GPU upgrades, run `gradio deploy` from the terminal in the working directory to deploy to Hugging Face Spaces (https://huggingface.co/spaces)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div><iframe src=\"https://cd465932b81ca1db1e.gradio.live\" width=\"100%\" height=\"500\" allow=\"autoplay; camera; microphone; clipboard-read; clipboard-write;\" frameborder=\"0\" allowfullscreen></iframe></div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": []
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "inputs = [\n",
    "    gr.Dropdown([\"Linear Regression\", \"Decision Tree\", \"Random Forest\"], value=\"Random Forest\", label=\"Model\"),\n",
    "    gr.Number(label=\"Age\", minimum=0),\n",
    "    gr.Dropdown([\"Male\", \"Female\"], label=\"Sex\"),\n",
    "    gr.Number(label=\"BMI\"),\n",
    "    gr.Number(label=\"Number of children\"),\n",
    "    gr.Dropdown([\"No\", \"Yes\"], label=\"Smoker\"),\n",
    "    gr.Dropdown([\"Northeast\", \"Northwest\", \"Southeast\", \"Southwest\"], label=\"Location\")\n",
    "]\n",
    "\n",
    "outputs = gr.Textbox(label=\"Predicted Charge\")\n",
    "\n",
    "PredictiveTool = gr.Interface(fn=predict, inputs=inputs, outputs=outputs, title=\"Medical Insurance Cost\")\n",
    "PredictiveTool.launch()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e4d59b9",
   "metadata": {
    "papermill": {
     "duration": 0.005572,
     "end_time": "2025-12-23T10:04:02.121588",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.116016",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## **2. Deliverables**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cff01c9f",
   "metadata": {
    "papermill": {
     "duration": 0.010361,
     "end_time": "2025-12-23T10:04:02.139013",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.128652",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **2.1 Dataset Description**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "37b48b69",
   "metadata": {
    "papermill": {
     "duration": 0.005828,
     "end_time": "2025-12-23T10:04:02.153481",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.147653",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **2.2 Preprocessing**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3d341c45",
   "metadata": {
    "papermill": {
     "duration": 0.005791,
     "end_time": "2025-12-23T10:04:02.164969",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.159178",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **2.3 Model Implementation**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2e83175",
   "metadata": {
    "papermill": {
     "duration": 0.007224,
     "end_time": "2025-12-23T10:04:02.178012",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.170788",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **2.4 Results**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9660a12f",
   "metadata": {
    "papermill": {
     "duration": 0.006334,
     "end_time": "2025-12-23T10:04:02.190126",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.183792",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **2.5 Interpretation**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bb61a2c2",
   "metadata": {
    "papermill": {
     "duration": 0.005622,
     "end_time": "2025-12-23T10:04:02.201429",
     "exception": false,
     "start_time": "2025-12-23T10:04:02.195807",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **2.6 Critical Reflection**\n",
    "---\n",
    "\n",
    "Initially, "
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 8129551,
     "sourceId": 12853160,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31192,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 21.701013,
   "end_time": "2025-12-23T10:04:04.827531",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-12-23T10:03:43.126518",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
